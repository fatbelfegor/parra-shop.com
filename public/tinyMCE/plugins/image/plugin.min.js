tinymce.PluginManager.add("image",function(a){function b(b){return function(){var c=a.settings.image_list;"string"==typeof c?tinymce.util.XHR.send({url:c,success:function(a){b(tinymce.util.JSON.parse(a))}}):"function"==typeof c?c(b):b(c)}}function c(){function j(b){function e(b){function d(){b.onload=b.onerror=null,a.selection&&(a.selection.select(b),a.nodeChanged())}b.onload=function(){data.width||data.height||!i||c.setAttribs(b,{width:b.clientWidth,height:b.clientHeight}),d()},b.onerror=d}data={src:b},a.undoManager.transact(function(){return data.src?(d?c.setAttribs(d,data):(data.id="__mcenew",a.focus(),a.selection.setContent(c.createHTML("img",data)),d=c.get("__mcenew"),c.setAttrib(d,"id",null)),e(d),void 0):(d&&(c.remove(d),a.focus(),a.nodeChanged()),void 0)})}var c=a.dom,d=a.selection.getNode(),i=a.settings.image_dimensions!==!1;d=null,image.add(j,"editor")}a.addButton("image",{icon:"image",tooltip:"Insert/edit image",onclick:b(c),stateSelector:"img:not([data-mce-object],[data-mce-placeholder])"}),a.addMenuItem("image",{icon:"image",text:"Insert image",onclick:b(c),context:"insert",prependToContext:!0}),a.addCommand("mceImage",b(c))});